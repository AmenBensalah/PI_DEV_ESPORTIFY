{% extends 'base.html.twig' %}

{% block title %}Mes enregistrements - E-sportify{% endblock %}

{% block body %}
<section class="saved-page" data-saved-page data-save-token="{{ csrf_token('post_save') }}">
    <div class="admin-tournament-hero saved-hero">
        <div class="admin-tournament-hero-inner">
            <div class="admin-tournament-kicker">Fil d'actualité</div>
            <h2 class="admin-tournament-title">
                <i class="fa-regular fa-bookmark"></i> MES PUBLICATIONS ENREGISTRÉES
            </h2>
            <p class="admin-tournament-lead">Retrouvez toutes les publications que vous avez sauvegardées.</p>
        </div>
        <div class="admin-tournament-hero-glow"></div>
    </div>

    <div class="saved-grid">
        {% if posts is empty %}
            <div class="glass-card post-card">
                <div class="post-content">Aucune publication enregistrée pour le moment.</div>
            </div>
        {% else %}
            {% for post in posts %}
                <article class="glass-card post-card {{ post.isEvent ? 'event-card' : '' }}"
                         data-post-id="{{ post.id }}"
                         id="post-{{ post.id }}"
                         data-save-url="{{ path('fil_post_save', {id: post.id}) }}"
                         data-saved="1"
                         data-remove-on-unsave="1">
                    <div class="post-header">
                        <div class="avatar">U</div>
                        <div class="post-meta">
                            <div class="post-author">{{ post.author ? (post.author.pseudo ?: post.author.nom) : 'Utilisateur' }}</div>
                            <div class="post-time">
                                {{ post.createdAt ? post.createdAt|date('d/m/Y H:i') : 'Maintenant' }}
                            </div>
                        </div>
                    </div>

                    {% if post.isEvent %}
                        <div class="event-header">
                            <div class="event-date">
                                {{ post.eventDate ? post.eventDate|date('d/m/Y H:i') : 'À confirmer' }}
                            </div>
                            <div class="event-title">{{ post.eventTitle ? post.eventTitle|upper : 'ÉVÉNEMENT' }}</div>
                            {% if post.eventLocation %}
                                <div class="event-location"><i class="fas fa-location-dot"></i> {{ post.eventLocation }}</div>
                            {% endif %}
                        </div>
                    {% endif %}

                    {% if post.content %}
                        <div class="post-content">{{ post.content }}</div>
                    {% endif %}

                    {% if post.imagePath %}
                        <div class="post-media">
                            <img src="{{ asset(post.imagePath starts with 'http' ? post.imagePath : 'uploads/' ~ post.imagePath) }}" alt="media">
                        </div>
                    {% elseif post.videoUrl %}
                        <div class="post-media">
                            <a class="media-placeholder" href="{{ post.videoUrl }}" target="_blank" rel="noopener">Voir la vidéo</a>
                        </div>
                    {% endif %}

                    <div class="post-actions">
                        <div class="reaction-row">
                            <button class="reaction-pill is-saved" type="button" data-save-button>
                                <i class="fa-regular fa-bookmark"></i> Retirer des enregistrements
                            </button>
                        </div>
                    </div>
                </article>
            {% endfor %}
        {% endif %}
    </div>
</section>
{% endblock %}
