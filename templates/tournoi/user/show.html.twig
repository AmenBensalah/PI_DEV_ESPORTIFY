{% extends 'base.html.twig' %}

{% block title %}{{ tournoi.name }}{% endblock %}

{% block body %}
<section class="tournoi-hero">
    <div class="tournoi-hero-inner">
        <div class="tournoi-kicker">Tournoi</div>
        <h1 class="tournoi-title">{{ tournoi.name }}</h1>
        <p class="tournoi-lead">{{ tournoi.game }} · {{ tournoi.typeGame }} · {{ tournoi.typeTournoi|upper }}</p>
        <div class="tournoi-hero-actions">
            <a href="{{ path('tournoi_index') }}" class="neo-btn ghost">Retour</a>
            <a href="{{ path('tournoi_participation_requests') }}" class="neo-btn">Mes demandes</a>
        </div>
    </div>
    <div class="tournoi-hero-glow"></div>
</section>

<section class="tournoi-shell">
    <div class="tournoi-panel tournoi-details">
        <div class="detail-grid">
            <div>
                <span>Type de jeu</span>
                <strong>{{ tournoi.typeGame }}</strong>
            </div>
            <div>
                <span>Type tournoi</span>
                <strong>{{ tournoi.typeTournoi|upper }}</strong>
            </div>
            <div>
                <span>Statut</span>
                {% if tournoi.currentStatus == 'planned' %}
                    <strong class="status warn">Planifie</strong>
                {% elseif tournoi.currentStatus == 'ongoing' %}
                    <strong class="status success">En cours</strong>
                {% else %}
                    <strong class="status danger">Termine</strong>
                {% endif %}
            </div>
            <div>
                <span>Debut</span>
                <strong>{{ tournoi.startDate|date('Y-m-d H:i') }}</strong>
            </div>
            <div>
                <span>Fin</span>
                <strong>{{ tournoi.endDate|date('Y-m-d H:i') }}</strong>
            </div>
            <div>
                <span>Prize</span>
                <strong>${{ tournoi.prizeWon }}</strong>
            </div>
        </div>

        {% if tournoi.resultat %}
            <div class="tournoi-alert success">
                <h4>Results</h4>
                <p><strong>Rank:</strong> {{ tournoi.resultat.rank }}</p>
                <p><strong>Score:</strong> {{ tournoi.resultat.score }}</p>
            </div>
        {% endif %}

        <div class="tournoi-actions-row">
            {% if is_granted('ROLE_USER') %}
                {% set remaining = tournoi.remainingPlaces %}
                {% if app.user in tournoi.participants %}
                    <button class="neo-btn" disabled>Inscrit</button>
                {% elseif remaining is not null and remaining <= 0 %}
                    <button class="neo-btn" disabled>Complet</button>
                {% elseif tournoi.currentStatus != 'planned' %}
                    <button class="neo-btn" disabled>Non disponible</button>
                {% else %}
                    <a href="{{ path('tournoi_participate', {id: tournoi.idTournoi}) }}" class="neo-btn">Participer</a>
                {% endif %}
            {% endif %}
            <a href="{{ path('tournoi_index') }}" class="neo-btn ghost">Retour</a>
        </div>
    </div>
</section>
{% endblock %}
